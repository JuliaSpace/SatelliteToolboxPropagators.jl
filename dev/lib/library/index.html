<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · SatelliteToolboxPropagators.jl</title><meta name="title" content="Library · SatelliteToolboxPropagators.jl"/><meta property="og:title" content="Library · SatelliteToolboxPropagators.jl"/><meta property="twitter:title" content="Library · SatelliteToolboxPropagators.jl"/><meta name="description" content="Documentation for SatelliteToolboxPropagators.jl."/><meta property="og:description" content="Documentation for SatelliteToolboxPropagators.jl."/><meta property="twitter:description" content="Documentation for SatelliteToolboxPropagators.jl."/><meta property="og:url" content="https://juliaspace.github.io/SatelliteToolboxPropagators.jl/stable/lib/library/"/><meta property="twitter:url" content="https://juliaspace.github.io/SatelliteToolboxPropagators.jl/stable/lib/library/"/><link rel="canonical" href="https://juliaspace.github.io/SatelliteToolboxPropagators.jl/stable/lib/library/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SatelliteToolboxPropagators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SatelliteToolboxPropagators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../man/quick_start/">Quick Start</a></li><li><a class="tocitem" href="../../man/usage/">Usage</a></li><li><span class="tocitem">Propagators</span><ul><li><a class="tocitem" href="../../man/propagators/j2/">J2</a></li><li><a class="tocitem" href="../../man/propagators/j2osc/">J2 Osculating</a></li><li><a class="tocitem" href="../../man/propagators/j4/">J4</a></li><li><a class="tocitem" href="../../man/propagators/j4osc/">J4 Osculating</a></li><li><a class="tocitem" href="../../man/propagators/sgp4/">SGP4/SDP4</a></li><li><a class="tocitem" href="../../man/propagators/twobody/">Two-Body</a></li></ul></li><li class="is-active"><a class="tocitem" href>Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/main/docs/src/lib/library.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Library"><a class="docs-heading-anchor" href="#Library">Library</a><a id="Library-1"></a><a class="docs-heading-anchor-permalink" href="#Library" title="Permalink"></a></h1><p>Documentation for <code>SatelliteToolboxPropagators.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J2OsculatingPropagator" href="#SatelliteToolboxPropagators.J2OsculatingPropagator"><code>SatelliteToolboxPropagators.J2OsculatingPropagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct J2OsculatingPropagator{Tepoch&lt;:Number, T&lt;:Number}</code></pre><p>J2 osculating orbit propagator structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J2Propagator" href="#SatelliteToolboxPropagators.J2Propagator"><code>SatelliteToolboxPropagators.J2Propagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct J2Propagator{Tepoch&lt;:Number, T&lt;:Number}</code></pre><p>J2 orbit propagator structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J2PropagatorConstants" href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>SatelliteToolboxPropagators.J2PropagatorConstants</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct J2PropagatorConstants{T&lt;:Number}</code></pre><p>Constants for the J2 orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>R0::T</code>: Earth equatorial radius [m].</li><li><code>μm::T</code>: √(GM / R0^3) [er/s]^(3/2).</li><li><code>J2::T</code>: The second gravitational zonal harmonic of the Earth.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L21-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J4OsculatingPropagator" href="#SatelliteToolboxPropagators.J4OsculatingPropagator"><code>SatelliteToolboxPropagators.J4OsculatingPropagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct J4OsculatingPropagator{Tepoch&lt;:Number, T&lt;:Number}</code></pre><p>J4 osculating orbit propagator structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L138-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J4Propagator" href="#SatelliteToolboxPropagators.J4Propagator"><code>SatelliteToolboxPropagators.J4Propagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">J4Propagator{Tepoch, T}</code></pre><p>J4 orbit propagator structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.J4PropagatorConstants" href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>SatelliteToolboxPropagators.J4PropagatorConstants</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct J4PropagatorConstants{T&lt;:Number}</code></pre><p>Constants for the J4 orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>R0::T</code>: Earth equatorial radius [m].</li><li><code>μm::T</code>: √(GM / R0^3) [er/s]^(3/2).</li><li><code>J2::T</code>: The second gravitational zonal harmonic of the Earth.</li><li><code>J4::T</code>: The fourth gravitational zonal harmonic of the Earth.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L91-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorJ2" href="#SatelliteToolboxPropagators.OrbitPropagatorJ2"><code>SatelliteToolboxPropagators.OrbitPropagatorJ2</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorJ2{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>J2 orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>j2d</code>: Structure that stores the J2 orbit propagator data (see <a href="#SatelliteToolboxPropagators.J2Propagator"><code>J2Propagator</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L191-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorJ2Osculating" href="#SatelliteToolboxPropagators.OrbitPropagatorJ2Osculating"><code>SatelliteToolboxPropagators.OrbitPropagatorJ2Osculating</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorJ2Osculating{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>J2 osculating orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>j2oscd</code>: Structure that stores the J2 osculating orbit propagator data (see   <a href="#SatelliteToolboxPropagators.J2OsculatingPropagator"><code>J2OsculatingPropagator</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L206-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorJ4" href="#SatelliteToolboxPropagators.OrbitPropagatorJ4"><code>SatelliteToolboxPropagators.OrbitPropagatorJ4</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorJ4{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>J4 orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>j4d</code>: Structure that stores the J4 orbit propagator data (see <a href="#SatelliteToolboxPropagators.J4Propagator"><code>J4Propagator</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L222-L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorJ4Osculating" href="#SatelliteToolboxPropagators.OrbitPropagatorJ4Osculating"><code>SatelliteToolboxPropagators.OrbitPropagatorJ4Osculating</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorJ4Osculating{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>J4 osculating orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>j4oscd</code>: Structure that stores the J4 osculating orbit propagator data (see   <a href="#SatelliteToolboxPropagators.J4OsculatingPropagator"><code>J4OsculatingPropagator</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L237-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorSgp4" href="#SatelliteToolboxPropagators.OrbitPropagatorSgp4"><code>SatelliteToolboxPropagators.OrbitPropagatorSgp4</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorSgp4{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>SGP4 orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>sgp4d</code>: Structure that stores the SGP4 orbit propagator data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L253-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.OrbitPropagatorTwoBody" href="#SatelliteToolboxPropagators.OrbitPropagatorTwoBody"><code>SatelliteToolboxPropagators.OrbitPropagatorTwoBody</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OrbitPropagatorTwoBody{Tepoch, T} &lt;: OrbitPropagator{Tepoch, T}</code></pre><p>Two body orbit propagator.</p><p><strong>Fields</strong></p><ul><li><code>tbd</code>: Structure that stores the two body orbit propagator data (see   <a href="#SatelliteToolboxPropagators.TwoBodyPropagator"><code>TwoBodyPropagator</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L268-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.TwoBodyPropagator" href="#SatelliteToolboxPropagators.TwoBodyPropagator"><code>SatelliteToolboxPropagators.TwoBodyPropagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct TwoBodyPropagator{Tepoch&lt;:Number, T&lt;:Number}</code></pre><p>Two body orbit propagator structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/types.jl#L163-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ2, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ2, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements!(orbp::OrbitPropagatorJ2, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector}</code></pre><p>Fit a set of mean Keplerian elements for the J2 orbit propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The orbit propagator <code>orbp</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2.jl#L73-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ2Osculating, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ2Osculating, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements!(orbp::OrbitPropagatorJ2Osculating, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector}</code></pre><p>Fit a set of mean Keplerian elements for the J2 osculating orbit propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The orbit propagator <code>orbp</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2osc.jl#L73-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ4, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ4, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements!(orbp::OrbitPropagatorJ4, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector}</code></pre><p>Fit a set of mean Keplerian elements for the J4 orbit propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The orbit propagator <code>orbp</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4.jl#L73-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ4Osculating, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorJ4Osculating, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements!(orbp::OrbitPropagatorJ4Osculating, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector}</code></pre><p>Fit a set of mean Keplerian elements for the J4 osculating orbit propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The orbit propagator <code>orbp</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4osc.jl#L76-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorSgp4, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{OrbitPropagatorSgp4, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements!(orbp::OrbitPropagatorSgp4, vjd::AbstractVector{Tjd}, vr_teme::AbstractVector{Tv}, vv_teme::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector}</code></pre><p>Fit a Two-Line Element set (<code>TLE</code>) for the SGP4 orbit propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_teme</code> [m] and a set of velocity vectors <code>vv_teme</code> [m / s] represented in the True-Equator, Mean-Equinox reference frame (TEME) at instants in the array <code>vjd</code> [Julian Day].</p><p>This algorithm was based on <strong>[1]</strong>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The SGP4 orbit propagator <code>orbp</code> will be initialized with the TLE returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>estimate_bstar::Bool</code>: If <code>true</code>, the algorithm will try to estimate the B* parameter.   Otherwise, it will be set to 0 or to the value in initial guess (see section  <strong>Initial   Guess</strong>).   (<strong>Default</strong> = true)</li><li><code>initial_guess::Union{Nothing, AbstractVector, TLE}</code>: Initial guess for the TLE fitting   process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from the   osculating elements in <code>vr_teme</code> and <code>vv_teme</code>. For more information, see the section   <strong>Initial Guess</strong>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted TLE.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li><li><code>classification::Char</code>: Satellite classification character for the output TLE.   (<strong>Default</strong> = &#39;U&#39;)</li><li><code>element_set_number::Int</code>: Element set number for the output TLE.   (<strong>Default</strong> = 0)</li><li><code>international_designator::String</code>: International designator string for the output TLE.   (<strong>Default</strong> = &quot;999999&quot;)</li><li><code>name::String</code>: Satellite name for the output TLE.   (<strong>Default</strong> = &quot;UNDEFINED&quot;)</li><li><code>revolution_number::Int</code>: Revolution number for the output TLE.   (<strong>Default</strong> = 0)</li><li><code>satellite_number::Int</code>: Satellite number for the output TLE.   (<strong>Default</strong> = 9999)</li></ul><p><strong>Returns</strong></p><ul><li><code>TLE</code>: The fitted TLE.</li><li><code>SMatrix{7, 7, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Initial Guess</strong></p><p>This algorithm uses a least-square algorithm to fit a TLE based on a set of osculating state vectors. Since the system is chaotic, a good initial guess is paramount for algorithm convergence. We can provide an initial guess using the keyword <code>initial_guess</code>.</p><p>If <code>initial_guess</code> is a <code>TLE</code>, we update the TLE epoch using the function <code>update_sgp4_tle_epoch!</code> to the desired one in <code>mean_elements_epoch</code>. Afterward, we use this new TLE as the initial guess.</p><p>If <code>initial_guess</code> is an <code>AbstractVector</code>, we use this vector as the initial mean state vector for the algorithm. It must contain 7 elements as follows:</p><pre><code class="nohighlight hljs">┌                                    ┐
│ IDs 1 to 3: Mean position [km]     │
│ IDs 4 to 6: Mean velocity [km / s] │
│ ID  7:      Bstar         [1 / er] │
└                                    ┘</code></pre><p>If <code>initial_guess</code> is <code>nothing</code>, the algorithm takes the closest osculating state vector to the <code>mean_elements_epoch</code> and uses it as the initial mean state vector. In this case, the epoch is set to the same epoch of the osculating data in <code>vjd</code>. When the fitted TLE is obtained, the algorithm uses the function <code>update_sgp4_tle_epoch!</code> to change its epoch to <code>mean_elements_epoch</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <code>initial_guess</code> is not <code>nothing</code>, the B* initial estimate is obtained from the TLE or the state vector. Hence, if <code>estimate_bstar</code> is <code>false</code>, it will be kept constant with this initial value.</p></div></div><p><strong>References</strong></p><ul><li><strong>[1]</strong> Vallado, D. A., Crawford, P (2008). SGP4 Orbit Determination. American Institute   of Aeronautics ans Astronautics.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/sgp4.jl#L171-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J2osc}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J2osc}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements(::Val{:J2osc}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J2 osculating orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 osculating propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>Propagators.fit_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2osc.jl#L12-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J2}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J2}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements(::Val{:J2}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J2 orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>Propagators.fit_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2.jl#L12-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J4osc}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J4osc}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements(::Val{:J4osc}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J4 osculating orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 osculating propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>Propagators.fit_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4osc.jl#L15-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J4}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:J4}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements(::Val{:J4}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J4 orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>Propagators.fit_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4.jl#L12-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:SGP4}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Val{:SGP4}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.fit_mean_elements(::Val{:SGP4}, vjd::AbstractVector{Tjd}, vr_teme::AbstractVector{Tv}, vv_teme::AbstractVector{Tv}; kwargs...) -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a Two-Line Element set (<code>TLE</code>) for the SGP4 orbit propagator using the osculating elements represented by a set of position vectors <code>vr_teme</code> [m] and a set of velocity vectors <code>vv_teme</code> [m / s] represented in the True-Equator, Mean-Equinox reference frame (TEME) at instants in the array <code>vjd</code> [Julian Day].</p><p>This algorithm was based on <strong>[1]</strong>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new SGP4 propagator with the default constants <code>sgp4c_wgs84</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>Propagators.fit_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>estimate_bstar::Bool</code>: If <code>true</code>, the algorithm will try to estimate the B* parameter.   Otherwise, it will be set to 0 or to the value in initial guess (see section  <strong>Initial   Guess</strong>).   (<strong>Default</strong> = true)</li><li><code>initial_guess::Union{Nothing, AbstractVector, TLE}</code>: Initial guess for the TLE fitting   process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from the   osculating elements in <code>vr_teme</code> and <code>vv_teme</code>. For more information, see the section   <strong>Initial Guess</strong>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted TLE.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li><li><code>classification::Char</code>: Satellite classification character for the output TLE.   (<strong>Default</strong> = &#39;U&#39;)</li><li><code>element_set_number::Int</code>: Element set number for the output TLE.   (<strong>Default</strong> = 0)</li><li><code>international_designator::String</code>: International designator string for the output TLE.   (<strong>Default</strong> = &quot;999999&quot;)</li><li><code>name::String</code>: Satellite name for the output TLE.   (<strong>Default</strong> = &quot;UNDEFINED&quot;)</li><li><code>revolution_number::Int</code>: Revolution number for the output TLE.   (<strong>Default</strong> = 0)</li><li><code>satellite_number::Int</code>: Satellite number for the output TLE.   (<strong>Default</strong> = 9999)</li></ul><p><strong>Returns</strong></p><ul><li><code>TLE</code>: The fitted TLE.</li><li><code>SMatrix{7, 7, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Initial Guess</strong></p><p>This algorithm uses a least-square algorithm to fit a TLE based on a set of osculating state vectors. Since the system is chaotic, a good initial guess is paramount for algorithm convergence. We can provide an initial guess using the keyword <code>initial_guess</code>.</p><p>If <code>initial_guess</code> is a <code>TLE</code>, we update the TLE epoch using the function <code>update_sgp4_tle_epoch!</code> to the desired one in <code>mean_elements_epoch</code>. Afterward, we use this new TLE as the initial guess.</p><p>If <code>initial_guess</code> is an <code>AbstractVector</code>, we use this vector as the initial mean state vector for the algorithm. It must contain 7 elements as follows:</p><pre><code class="nohighlight hljs">┌                                    ┐
│ IDs 1 to 3: Mean position [km]     │
│ IDs 4 to 6: Mean velocity [km / s] │
│ ID  7:      Bstar         [1 / er] │
└                                    ┘</code></pre><p>If <code>initial_guess</code> is <code>nothing</code>, the algorithm takes the closest osculating state vector to the <code>mean_elements_epoch</code> and uses it as the initial mean state vector. In this case, the epoch is set to the same epoch of the osculating data in <code>vjd</code>. When the fitted TLE is obtained, the algorithm uses the function <code>update_sgp4_tle_epoch!</code> to change its epoch to <code>mean_elements_epoch</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <code>initial_guess</code> is not <code>nothing</code>, the B* initial estimate is obtained from the TLE or the state vector. Hence, if <code>estimate_bstar</code> is <code>false</code>, it will be kept constant with this initial value.</p></div></div><p><strong>References</strong></p><ul><li><strong>[1]</strong> Vallado, D. A., Crawford, P (2008). SGP4 Orbit Determination. American Institute   of Aeronautics ans Astronautics.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/sgp4.jl#L55-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ2, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ2, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorJ2, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J2 orbit propagator structure <code>orbp</code> using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j2c::J2PropagatorConstants</code> in <code>orbp.j2d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2.jl#L158-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ2Osculating, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ2Osculating, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorJ2Osculating, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J2 osculating orbit propagator structure <code>orbp</code> using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j2c::J2PropagatorConstants</code> in <code>orbp.j2d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2osc.jl#L158-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ4, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ4, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorJ4, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J4 orbit propagator structure <code>orbp</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j4c::J4PropagatorConstants</code> in <code>j4d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4.jl#L159-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ4Osculating, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorJ4Osculating, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorJ4Osculating, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J4 osculating orbit propagator structure <code>orbp</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j4c::J4PropagatorConstants</code> in <code>orbp.j4d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4osc.jl#L161-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorSgp4, TLE}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorSgp4, TLE}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorSgp4, epoch::Number, n₀::Number, e₀::Number, i₀::Number, Ω₀::Number, ω₀::Number, M₀::Number, bstar::Number; kwargs...) -&gt; Nothing
Propagators.init!(orbp::OrbitPropagatorSgp4, tle::TLE; kwargs...) -&gt; Nothing</code></pre><p>Initialize the SGP4 orbit propagator structure <code>orbp</code> using the initial orbit specified by the arguments.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>sgp4c::Sgp4Constants</code> in <code>orbp.sgp4d</code> will not be changed. Hence, they must be initialized.</p></div></div><p><strong>Arguments</strong></p><ul><li><code>epoch::Number</code>: Epoch of the orbital elements [Julian Day].</li><li><code>n₀::Number</code>: SGP type &quot;mean&quot; mean motion at epoch [rad/s].</li><li><code>e₀::Number</code>: &quot;Mean&quot; eccentricity at epoch.</li><li><code>i₀::Number</code>: &quot;Mean&quot; inclination at epoch [rad].</li><li><code>Ω₀::Number</code>: &quot;Mean&quot; longitude of the ascending node at epoch [rad].</li><li><code>ω₀::Number</code>: &quot;Mean&quot; argument of perigee at epoch [rad].</li><li><code>M₀::Number</code>: &quot;Mean&quot; mean anomaly at epoch [rad].</li><li><code>bstar::Number</code>: Drag parameter (B*).</li><li><code>tle::TLE</code>: Two-line elements used for the initialization.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/sgp4.jl#L336-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorTwoBody, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init!-Tuple{OrbitPropagatorTwoBody, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init!(orbp::OrbitPropagatorTwoBody, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the two-body orbit propagator structure <code>orbp</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constant <code>m0::Number</code> in <code>tbd</code> will not be changed. Hence, it must be initialized.</p></div></div><p><strong>Arguments</strong></p><ul><li><code>orb₀::KeplerianElements</code>: Initial mean Keplerian elements [SI units].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/twobody.jl#L33-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J2osc}, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J2osc}, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:J2osc), orb₀::KeplerianElements; kwargs...) -&gt; OrbitPropagatorJ2Osculating</code></pre><p>Create and initialize the J2 osculating orbit propagator structure using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2osc.jl#L133-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J2}, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J2}, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:J2), orb₀::KeplerianElements; kwargs...) -&gt; OrbitPropagatorJ2</code></pre><p>Create and initialize the J2 orbit propagator structure using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j2.jl#L133-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J4osc}, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J4osc}, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:J4osc), orb₀::KeplerianElements; kwargs...) -&gt; OrbitPropagatorJ4Osculating</code></pre><p>Create and initialize the J4 osculating orbit propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants</code>: J4 orbit propagator constants (see <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4osc.jl#L136-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J4}, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:J4}, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:J4), orb₀::Orbit; kwargs...) -&gt; OrbitPropagatorJ4</code></pre><p>Create and initialize the J4 orbit propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants</code>: J4 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/j4.jl#L133-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:SGP4}, TLE}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:SGP4}, TLE}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:SGP4), epoch::Number, n₀::Number, e₀::Number, i₀::Number, Ω₀::Number, ω₀::Number, M₀::Number, bstar::Number; kwargs...) -&gt; OrbitPropagatorSgp4
Propagators.init(Val(:SGP4), tle::TLE; kwargs...) -&gt; OrbitPropagatorSgp4</code></pre><p>Create and initialize the SGP4 orbit propagator structure using the initial orbit specified by the arguments.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>sgp4c</code>.</p></div></div><p><strong>Arguments</strong></p><ul><li><code>epoch::Number</code>: Epoch of the orbital elements [Julian Day].</li><li><code>n₀::Number</code>: SGP type &quot;mean&quot; mean motion at epoch [rad/s].</li><li><code>e₀::Number</code>: &quot;Mean&quot; eccentricity at epoch.</li><li><code>i₀::Number</code>: &quot;Mean&quot; inclination at epoch [rad].</li><li><code>Ω₀::Number</code>: &quot;Mean&quot; longitude of the ascending node at epoch [rad].</li><li><code>ω₀::Number</code>: &quot;Mean&quot; argument of perigee at epoch [rad].</li><li><code>M₀::Number</code>: &quot;Mean&quot; mean anomaly at epoch [rad].</li><li><code>bstar::Number</code>: Drag parameter (B*).</li><li><code>tle::TLE</code>: Two-line elements used for the initialization.</li></ul><p><strong>Keywords</strong></p><ul><li><code>sgp4c::Sgp4Constants</code>: SGP4 orbit propagator constants (see <code>Sgp4Constants</code>).   (<strong>Default</strong> = <code>sgp4c_wgs84</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/sgp4.jl#L286-L314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:TwoBody}, KeplerianElements}" href="#SatelliteToolboxPropagators.Propagators.init-Tuple{Val{:TwoBody}, KeplerianElements}"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Propagators.init(Val(:TwoBody), orb₀::KeplerianElements; kwargs...) -&gt; OrbitPropagatorTwoBody</code></pre><p>Create and initialize the two-body orbit propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the gravitational constant <code>m0</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>m0::T</code>: Standard gravitational parameter of the central body [m³ / s²].   (<strong>Default</strong> = <code>tbc_m0</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/twobody.jl#L12-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators._j2_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J2Propagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators._j2_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J2Propagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators._j2_jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_j2_jacobian(j2d::J2OsculatingPropagator{Tepoch, T}, Δt::Number, x₁::SVector{6, T}, y₁::SVector{6, T}; kwargs...)) where {T&lt;:Number, Tepoch&lt;:Number} -&gt; SMatrix{6, 6, T}</code></pre><p>Compute the J2 orbit propagator Jacobian by finite-differences using the propagator <code>j2d</code> at instant <code>Δt</code> considering the input mean elements <code>x₁</code> that must provide the output vector <code>y₁</code>. Hence:</p><pre><code class="nohighlight hljs">    ∂j2(x, Δt) │
J = ────────── │
        ∂x     │ x = x₁</code></pre><p><strong>Keywords</strong></p><ul><li><code>perturbation::T</code>: Initial state perturbation to compute the finite-difference:   <code>Δx = x * perturbation</code>.   (<strong>Default</strong> = 1e-3)</li><li><code>perturbation_tol::T</code>: Tolerance to accept the perturbation. If the computed perturbation   is lower than <code>perturbation_tol</code>, we increase it until it absolute value is higher than   <code>perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L906-L926">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators._j2osc_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J2OsculatingPropagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators._j2osc_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J2OsculatingPropagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators._j2osc_jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_j2osc_jacobian(j2oscd::J2OsculatingPropagator{Tepoch, T}, Δt::Number, x₁::SVector{6, T}, y₁::SVector{6, T}; kwargs...)) where {T&lt;:Number, Tepoch&lt;:Number} -&gt; SMatrix{6, 6, T}</code></pre><p>Compute the J2 osculating orbit propagator Jacobian by finite-differences using the propagator <code>j2oscd</code> at instant <code>Δt</code> considering the input mean elements <code>x₁</code> that must provide the output vector <code>y₁</code>. Hence:</p><pre><code class="nohighlight hljs">    ∂j2osc(x, Δt) │
J = ───────────── │
          ∂x      │ x = x₁</code></pre><p><strong>Keywords</strong></p><ul><li><code>perturbation::T</code>: Initial state perturbation to compute the finite-difference:   <code>Δx = x * perturbation</code>.   (<strong>Default</strong> = 1e-3)</li><li><code>perturbation_tol::T</code>: Tolerance to accept the perturbation. If the computed perturbation   is lower than <code>perturbation_tol</code>, we increase it until it absolute value is higher than   <code>perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L846-L866">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators._j4_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J4Propagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators._j4_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J4Propagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators._j4_jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_j4_jacobian(j4d::J4OsculatingPropagator{Tepoch, T}, Δt::Number, x₁::SVector{6, T}, y₁::SVector{6, T}; kwargs...)) where {T&lt;:Number, Tepoch&lt;:Number} -&gt; SMatrix{6, 6, T}</code></pre><p>Compute the J4 orbit propagator Jacobian by finite-differences using the propagator <code>j4d</code> at instant <code>Δt</code> considering the input mean elements <code>x₁</code> that must provide the output vector <code>y₁</code>. Hence:</p><pre><code class="nohighlight hljs">    ∂j4(x, Δt) │
J = ────────── │
        ∂x     │ x = x₁</code></pre><p><strong>Keywords</strong></p><ul><li><code>perturbation::T</code>: Initial state perturbation to compute the finite-difference:   <code>Δx = x * perturbation</code>.   (<strong>Default</strong> = 1e-3)</li><li><code>perturbation_tol::T</code>: Tolerance to accept the perturbation. If the computed perturbation   is lower than <code>perturbation_tol</code>, we increase it until it absolute value is higher than   <code>perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L940-L960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators._j4osc_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J4OsculatingPropagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators._j4osc_jacobian-Union{Tuple{Tepoch}, Tuple{T}, Tuple{J4OsculatingPropagator{Tepoch, T}, Number, StaticArraysCore.SVector{6, T}, StaticArraysCore.SVector{6, T}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators._j4osc_jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_j4osc_jacobian(j4oscd::J4OsculatingPropagator{Tepoch, T}, Δt::Number, x₁::SVector{6, T}, y₁::SVector{6, T}; kwargs...)) where {T&lt;:Number, Tepoch&lt;:Number} -&gt; SMatrix{6, 6, T}</code></pre><p>Compute the J4 osculating orbit propagator Jacobian by finite-differences using the propagator <code>j4oscd</code> at instant <code>Δt</code> considering the input mean elements <code>x₁</code> that must provide the output vector <code>y₁</code>. Hence:</p><pre><code class="nohighlight hljs">    ∂j4osc(x, Δt) │
J = ───────────── │
          ∂x      │ x = x₁</code></pre><p><strong>Keywords</strong></p><ul><li><code>perturbation::T</code>: Initial state perturbation to compute the finite-difference:   <code>Δx = x * perturbation</code>.   (<strong>Default</strong> = 1e-3)</li><li><code>perturbation_tol::T</code>: Tolerance to accept the perturbation. If the computed perturbation   is lower than <code>perturbation_tol</code>, we increase it until it absolute value is higher than   <code>perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L845-L865">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j2_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j2_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j2_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j2_mean_elements!(j2d::J2Propagator{Tepoch, T}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Tepoch, T}, SMatrix{6, 6, T}</code></pre><p>Fit a set of mean Keplerian elements for the J2 orbit propagator <code>j2d</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J2 orbit propagator <code>j2d</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Tepoch, T}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Allocate a new J2 orbit propagator using a dummy Keplerian elements.
julia&gt; j2d = j2_init(KeplerianElements{Float64, Float64}(0, 7000e3, 0, 0, 0, 0, 0));

julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118]  .* 1000,
           [-1781.214419290065, 1619.7795321872854, 6707.771633846665]    .* 1000,
           [ 5693.643675547716, -1192.342828671633, 4123.976025977494]    .* 1000,
           [ 5291.613719530499, -2354.5417593130833, -4175.561367156414]  .* 1000,
           [-2416.3705905186903, -268.74923235392623, -6715.411357310478] .* 1000,
           [-6795.043410709359, 2184.4414321930635, -0.4327055325971031]  .* 1000,
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984]    .* 1000,
           [6.875680282038698, -1.864319399615942, 2.270603214569518]     .* 1000,
           [3.8964090757666496, -2.1887896252945875, -5.9960180359219075] .* 1000,
           [-4.470258022565413, 0.5119576359985208, -5.9608372367141635]  .* 1000,
           [-6.647358060413909, 2.495415251255861, 2.292118747543002]     .* 1000,
           [0.3427096905434428, 1.040125572862349, 7.3936887585116855]    .* 1000,
       ];

julia&gt; vjd = [
           2.46002818657856e6
           2.460028200467449e6
           2.460028214356338e6
           2.4600282282452267e6
           2.4600282421341157e6
           2.4600282560230047e6
       ];

julia&gt; orb, P = fit_j2_mean_elements!(j2d, vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J2 propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:         23               4.3413           0.00540076              4341.31         -2.90721e-06 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T18:08:40.388), [0.16604846233666615 0.06643574144803302 … -3.85541368066423e-5 0.000124032254172014; 0.0664357414470214 0.26633448262787296 … -1.7943612056596758e-5 -1.9567956793856743e-5; … ; -3.855413680493565e-5 -1.7943612058983507e-5 … 4.3971984339116176e-7 -8.092704691911699e-8; 0.0001240322541726098 -1.9567956793417353e-5 … -8.092704692135158e-8 1.2451922454639337e-7])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T18:08:40.388)
 Semi-major axis : 7131.63       km
    Eccentricity :    0.00114299
     Inclination :   98.4366     °
            RAAN :  162.177      °
 Arg. of Perigee :  101.286      °
    True Anomaly :  258.689      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L443-L544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j2_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j2_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j2_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j2_mean_elements(vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J2 orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.fit_j2_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>fit_j2_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118]  .* 1000,
           [-1781.214419290065, 1619.7795321872854, 6707.771633846665]    .* 1000,
           [ 5693.643675547716, -1192.342828671633, 4123.976025977494]    .* 1000,
           [ 5291.613719530499, -2354.5417593130833, -4175.561367156414]  .* 1000,
           [-2416.3705905186903, -268.74923235392623, -6715.411357310478] .* 1000,
           [-6795.043410709359, 2184.4414321930635, -0.4327055325971031]  .* 1000,
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984]    .* 1000,
           [6.875680282038698, -1.864319399615942, 2.270603214569518]     .* 1000,
           [3.8964090757666496, -2.1887896252945875, -5.9960180359219075] .* 1000,
           [-4.470258022565413, 0.5119576359985208, -5.9608372367141635]  .* 1000,
           [-6.647358060413909, 2.495415251255861, 2.292118747543002]     .* 1000,
           [0.3427096905434428, 1.040125572862349, 7.3936887585116855]    .* 1000,
       ];

julia&gt; vjd = [
           2.46002818657856e6
           2.460028200467449e6
           2.460028214356338e6
           2.4600282282452267e6
           2.4600282421341157e6
           2.4600282560230047e6
       ];

julia&gt; orb, P = fit_j2_mean_elements(vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J2 propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:         23               4.3413           0.00540076              4341.31         -2.90721e-06 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T18:08:40.388), [0.16604846233666615 0.06643574144803302 … -3.85541368066423e-5 0.000124032254172014; 0.0664357414470214 0.26633448262787296 … -1.7943612056596758e-5 -1.9567956793856743e-5; … ; -3.855413680493565e-5 -1.7943612058983507e-5 … 4.3971984339116176e-7 -8.092704691911699e-8; 0.0001240322541726098 -1.9567956793417353e-5 … -8.092704692135158e-8 1.2451922454639337e-7])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T18:08:40.388)
 Semi-major axis : 7131.63       km
    Eccentricity :    0.00114299
     Inclination :   98.4366     °
            RAAN :  162.177      °
 Arg. of Perigee :  101.286      °
    True Anomaly :  258.689      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L328-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j2osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j2osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j2osc_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j2osc_mean_elements!(j2oscd::J2OsculatingPropagator{Tepoch, T}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Tepoch, T}, SMatrix{6, 6, T}</code></pre><p>Fit a set of mean Keplerian elements for the J2 osculating orbit propagator <code>j2oscd</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J2 osculating orbit propagator <code>j2oscd</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Tepoch, T}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Allocate a new J2 osculating orbit propagator using a dummy Keplerian elements.
julia&gt; j2oscd = j2osc_init(KeplerianElements{Float64, Float64}(0, 7000e3, 0, 0, 0, 0, 0));

julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118] .* 1000,
           [-6357.88873265975, 2391.9476768911686, 2181.838771262736] .* 1000
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984] .* 1000,
           [2.5285015912807003, 0.27812476784300005, 7.030323100703928] .* 1000
       ];

julia&gt; vjd = [
           2.46002818657856e6,
           2.460028190050782e6
       ];

julia&gt; orb, P = fit_j2osc_mean_elements!(j2oscd, vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J2 osculating propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:          4          1.69161e-05           0.00260193              2.60198         -2.06772e-09 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T16:33:40.388), [0.9999427882949705 -0.0049011518111948425 … -0.00012021282848110985 -0.00011550570919063845; -0.00490115181520327 1.0007325785722665 … 0.0032661568999667063 3.8567115793316056e-5; … ; -0.00012021282849269182 0.003266156899966125 … 2.204826778451109e-5 5.382733068487529e-8; -0.00011550570919086411 3.8567115786674836e-5 … 5.382733066340212e-8 2.1657420198753813e-5])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T16:33:40.388)
 Semi-major axis : 7135.8        km
    Eccentricity :    0.00135383
     Inclination :   98.4304     °
            RAAN :  162.113      °
 Arg. of Perigee :   64.9256     °
    True Anomaly :  313.085      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L391-L480">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j2osc_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j2osc_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j2osc_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j2osc_mean_elements(vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J2 osculating orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 osculating propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.fit_j2osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J2OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>fit_j2osc_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118] .* 1000,
           [-6357.88873265975, 2391.9476768911686, 2181.838771262736] .* 1000
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984] .* 1000,
           [2.5285015912807003, 0.27812476784300005, 7.030323100703928] .* 1000
       ];

julia&gt; vjd = [
           2.46002818657856e6,
           2.460028190050782e6
       ];

julia&gt; orb, P = fit_j2osc_mean_elements(vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J2 osculating propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:          4          1.69161e-05           0.00260193              2.60198         -2.06772e-09 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T16:33:40.388), [0.9999427882949705 -0.0049011518111948425 … -0.00012021282848110985 -0.00011550570919063845; -0.00490115181520327 1.0007325785722665 … 0.0032661568999667063 3.8567115793316056e-5; … ; -0.00012021282849269182 0.003266156899966125 … 2.204826778451109e-5 5.382733068487529e-8; -0.00011550570919086411 3.8567115786674836e-5 … 5.382733066340212e-8 2.1657420198753813e-5])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T16:33:40.388)
 Semi-major axis : 7135.8        km
    Eccentricity :    0.00135383
     Inclination :   98.4304     °
            RAAN :  162.113      °
 Arg. of Perigee :   64.9256     °
    True Anomaly :  313.085      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L284-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j4_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j4_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j4_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j4_mean_elements!(j4d::J4Propagator{Tepoch, T}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Tepoch, T}, SMatrix{6, 6, T}</code></pre><p>Fit a set of mean Keplerian elements for the J4 orbit propagator <code>j4d</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J4 orbit propagator <code>j4d</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Tepoch, T}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Allocate a new J4 orbit propagator using a dummy Keplerian elements.
julia&gt; j4d = j4_init(KeplerianElements{Float64, Float64}(0, 7000e3, 0, 0, 0, 0, 0));

julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118]  .* 1000,
           [-1781.214419290065, 1619.7795321872854, 6707.771633846665]    .* 1000,
           [ 5693.643675547716, -1192.342828671633, 4123.976025977494]    .* 1000,
           [ 5291.613719530499, -2354.5417593130833, -4175.561367156414]  .* 1000,
           [-2416.3705905186903, -268.74923235392623, -6715.411357310478] .* 1000,
           [-6795.043410709359, 2184.4414321930635, -0.4327055325971031]  .* 1000,
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984]    .* 1000,
           [6.875680282038698, -1.864319399615942, 2.270603214569518]     .* 1000,
           [3.8964090757666496, -2.1887896252945875, -5.9960180359219075] .* 1000,
           [-4.470258022565413, 0.5119576359985208, -5.9608372367141635]  .* 1000,
           [-6.647358060413909, 2.495415251255861, 2.292118747543002]     .* 1000,
           [0.3427096905434428, 1.040125572862349, 7.3936887585116855]    .* 1000,
       ];

julia&gt; vjd = [
           2.46002818657856e6
           2.460028200467449e6
           2.460028214356338e6
           2.4600282282452267e6
           2.4600282421341157e6
           2.4600282560230047e6
       ];

julia&gt; orb, P = fit_j4_mean_elements!(j4d, vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J4 propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:         23              4.33863           0.00539962              4338.63         -2.90777e-06 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T18:08:40.388), [0.16604866262321472 0.06643593039980161 … -3.8553206984036995e-5 0.00012403204426258087; 0.06643593040175688 0.26633435614867085 … -1.7942563356579497e-5 -1.95681107792859e-5; … ; -3.855320698470177e-5 -1.794256335557519e-5 … 4.3972013198895673e-7 -8.092682623169118e-8; 0.000124032044261828 -1.9568110780915995e-5 … -8.092682623078798e-8 1.2451901466558624e-7])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T18:08:40.388)
 Semi-major axis : 7131.64       km
    Eccentricity :    0.00114298
     Inclination :   98.4366     °
            RAAN :  162.177      °
 Arg. of Perigee :  101.282      °
    True Anomaly :  258.693      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L477-L578">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j4_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j4_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j4_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j4_mean_elements(vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J4 orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.fit_j4_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4Propagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>fit_j4_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118]  .* 1000,
           [-1781.214419290065, 1619.7795321872854, 6707.771633846665]    .* 1000,
           [ 5693.643675547716, -1192.342828671633, 4123.976025977494]    .* 1000,
           [ 5291.613719530499, -2354.5417593130833, -4175.561367156414]  .* 1000,
           [-2416.3705905186903, -268.74923235392623, -6715.411357310478] .* 1000,
           [-6795.043410709359, 2184.4414321930635, -0.4327055325971031]  .* 1000,
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984]    .* 1000,
           [6.875680282038698, -1.864319399615942, 2.270603214569518]     .* 1000,
           [3.8964090757666496, -2.1887896252945875, -5.9960180359219075] .* 1000,
           [-4.470258022565413, 0.5119576359985208, -5.9608372367141635]  .* 1000,
           [-6.647358060413909, 2.495415251255861, 2.292118747543002]     .* 1000,
           [0.3427096905434428, 1.040125572862349, 7.3936887585116855]    .* 1000,
       ];

julia&gt; vjd = [
           2.46002818657856e6
           2.460028200467449e6
           2.460028214356338e6
           2.4600282282452267e6
           2.4600282421341157e6
           2.4600282560230047e6
       ];

julia&gt; orb, P = fit_j4_mean_elements(vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J4 propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:         23              4.33863           0.00539962              4338.63         -2.90777e-06 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T18:08:40.388), [0.16604866262321472 0.06643593039980161 … -3.8553206984036995e-5 0.00012403204426258087; 0.06643593040175688 0.26633435614867085 … -1.7942563356579497e-5 -1.95681107792859e-5; … ; -3.855320698470177e-5 -1.794256335557519e-5 … 4.3972013198895673e-7 -8.092682623169118e-8; 0.000124032044261828 -1.9568110780915995e-5 … -8.092682623078798e-8 1.2451901466558624e-7])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T18:08:40.388)
 Semi-major axis : 7131.64       km
    Eccentricity :    0.00114298
     Inclination :   98.4366     °
            RAAN :  162.177      °
 Arg. of Perigee :  101.282      °
    True Anomaly :  258.693      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L362-L461">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j4osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j4osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j4osc_mean_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j4osc_mean_elements!(j4oscd::J4OsculatingPropagator{Tepoch, T}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Tepoch, T}, SMatrix{6, 6, T}</code></pre><p>Fit a set of mean Keplerian elements for the J4 osculating orbit propagator <code>j4oscd</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J4 osculating orbit propagator <code>j4oscd</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Tepoch, T}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, T}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Allocate a new J4 osculating orbit propagator using a dummy Keplerian elements.
julia&gt; j4oscd = j4osc_init(KeplerianElements{Float64, Float64}(0, 7000e3, 0, 0, 0, 0, 0));

julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118] .* 1000,
           [-6357.88873265975, 2391.9476768911686, 2181.838771262736] .* 1000
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984] .* 1000,
           [2.5285015912807003, 0.27812476784300005, 7.030323100703928] .* 1000
       ];

julia&gt; vjd = [
           2.46002818657856e6,
           2.460028190050782e6
       ];

julia&gt; orb, P = fit_j4osc_mean_elements!(j4oscd, vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J4 osculating propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:          4          1.68852e-05           0.00259716              2.59722          6.52143e-10 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T16:33:40.388), [0.999942775712293 -0.004901178682591695 … -0.00012021347649120565 -0.0001155014732440418; -0.004901178674245216 1.0007325984965127 … 0.0032661543862499806 3.8581997167487534e-5; … ; -0.00012021347646254671 0.003266154386250846 … 2.204822797002821e-5 5.3982040158043245e-8; -0.00011550147323899825 3.8581997169916946e-5 … 5.398204016417114e-8 2.1657607378172235e-5])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T16:33:40.388)
 Semi-major axis : 7135.79       km
    Eccentricity :    0.00135314
     Inclination :   98.4304     °
            RAAN :  162.113      °
 Arg. of Perigee :   64.9687     °
    True Anomaly :  313.042      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L390-L479">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.fit_j4osc_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}" href="#SatelliteToolboxPropagators.fit_j4osc_mean_elements-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>SatelliteToolboxPropagators.fit_j4osc_mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_j4osc_mean_elements(vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; KeplerianElements{Float64, Float64}, SMatrix{6, 6, Float64}</code></pre><p>Fit a set of mean Keplerian elements for the J4 osculating orbit propagator using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 osculating propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.fit_j4osc_mean_elements!-Union{Tuple{Tv}, Tuple{Tjd}, Tuple{Tepoch}, Tuple{T}, Tuple{J4OsculatingPropagator{Tepoch, T}, AbstractVector{Tjd}, AbstractVector{Tv}, AbstractVector{Tv}}} where {T&lt;:Number, Tepoch&lt;:Number, Tjd&lt;:Number, Tv&lt;:(AbstractVector)}"><code>fit_j4osc_mean_elements!</code></a> instead.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>atol::Number</code>: Tolerance for the residue absolute value. If the residue is lower than   <code>atol</code> at any iteration, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>rtol::Number</code>: Tolerance for the relative difference between the residues. If the   relative difference between the residues in two consecutive iterations is lower than   <code>rtol</code>, the computation loop stops.   (<strong>Default</strong> = 2e-4)</li><li><code>initial_guess::Union{Nothing, KeplerianElements}</code>: Initial guess for the mean elements   fitting process. If it is <code>nothing</code>, the algorithm will obtain an initial estimate from   the osculating elements in <code>vr_i</code> and <code>vv_i</code>.   (<strong>Default</strong> = nothing)</li><li><code>jacobian_perturbation::Number</code>: Initial state perturbation to compute the   finite-difference when calculating the Jacobian matrix.   (<strong>Default</strong> = 1e-3)</li><li><code>jacobian_perturbation_tol::Number</code>: Tolerance to accept the perturbation when calculating   the Jacobian matrix. If the computed perturbation is lower than   <code>jacobian_perturbation_tol</code>, we increase it until it absolute value is higher than   <code>jacobian_perturbation_tol</code>.   (<strong>Default</strong> = 1e-7)</li><li><code>max_iterations::Int</code>: Maximum number of iterations allowed for the least-square fitting.   (<strong>Default</strong> = 50)</li><li><code>mean_elements_epoch::Number</code>: Epoch for the fitted mean elements.   (<strong>Default</strong> = vjd[end])</li><li><code>verbose::Bool</code>: If <code>true</code>, the algorithm prints debugging information to <code>stdout</code>.   (<strong>Default</strong> = true)</li><li><code>weight_vector::AbstractVector</code>: Vector with the measurements weights for the least-square   algorithm. We assemble the weight matrix <code>W</code> as a diagonal matrix with the elements in   <code>weight_vector</code> at its diagonal.   (<strong>Default</strong> = <code>@SVector(ones(Bool, 6))</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>KeplerianElements{Float64, Float64}</code>: Fitted Keplerian elements.</li><li><code>SMatrix{6, 6, Float64}</code>: Final covariance matrix of the least-square algorithm.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118] .* 1000,
           [-6357.88873265975, 2391.9476768911686, 2181.838771262736] .* 1000
       ];

julia&gt; vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984] .* 1000,
           [2.5285015912807003, 0.27812476784300005, 7.030323100703928] .* 1000
       ];

julia&gt; vjd = [
           2.46002818657856e6,
           2.460028190050782e6
       ];

julia&gt; orb, P = fit_j4osc_mean_elements(vjd, vr_i, vv_i)
ACTION:   Fitting the mean elements for the J4 osculating propagator.
           Iteration        Position RMSE        Velocity RMSE           Total RMSE       RMSE Variation
                                     [km]             [km / s]                  [ ]
PROGRESS:          4          1.68852e-05           0.00259716              2.59722          6.52143e-10 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T16:33:40.388), [0.999942775712293 -0.004901178682591695 … -0.00012021347649120565 -0.0001155014732440418; -0.004901178674245216 1.0007325984965127 … 0.0032661543862499806 3.8581997167487534e-5; … ; -0.00012021347646254671 0.003266154386250846 … 2.204822797002821e-5 5.3982040158043245e-8; -0.00011550147323899825 3.8581997169916946e-5 … 5.398204016417114e-8 2.1657607378172235e-5])

julia&gt; orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T16:33:40.388)
 Semi-major axis : 7135.79       km
    Eccentricity :    0.00135314
     Inclination :   98.4304     °
            RAAN :  162.113      °
 Arg. of Perigee :   64.9687     °
    True Anomaly :  313.042      °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L283-L370">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2Propagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j2!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2Propagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j2!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2!(j2d::J2Propagator{Tepoch, T}, t::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit defined in <code>j2d</code> (see <a href="#SatelliteToolboxPropagators.J2Propagator"><code>J2Propagator</code></a>) to <code>t</code> [s] after the epoch of the input mean elements in <code>j2d</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The internal values in <code>j2d</code> will be modified.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L266-L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2-Tuple{Number, KeplerianElements}" href="#SatelliteToolboxPropagators.j2-Tuple{Number, KeplerianElements}"><code>SatelliteToolboxPropagators.j2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2(Δt::Number, orb₀::KeplerianElements; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, J2Propagator</code></pre><p>Initialize the J2 propagator structure using the input elements <code>orb₀</code> [SI units] and propagate the orbit until the time Δt [s].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.J2Propagator"><code>J2Propagator</code></a>: Structure with the initialized parameters.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L229-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2Propagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j2_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2Propagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j2_init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2_init!(j2d::J2Propagator, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J2 orbit propagator structure <code>j2d</code> using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j2c::J2PropagatorConstants</code> in <code>j2d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L164-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j2_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j2_init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2_init(orb₀::KeplerianElements; kwargs...) -&gt; J2Propagator</code></pre><p>Create and initialize the J2 orbit propagator structure using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L131-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2osc!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2OsculatingPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j2osc!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J2OsculatingPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j2osc!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2osc!(j2oscd::J2OsculatingPropagator{Tepoch, T}, t::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit defined in <code>j2oscd</code> (see <a href="#SatelliteToolboxPropagators.J2OsculatingPropagator"><code>J2OsculatingPropagator</code></a>) to <code>t</code> [s] after the epoch of the input mean elements in <code>j2d</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The internal values in <code>j2oscd</code> will be modified.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L145-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2osc-Tuple{Number, KeplerianElements}" href="#SatelliteToolboxPropagators.j2osc-Tuple{Number, KeplerianElements}"><code>SatelliteToolboxPropagators.j2osc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2osc(Δt::Number, orb₀::KeplerianElements; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, J2OsculatingPropagator</code></pre><p>Initialize the J2 osculating propagator structure using the input elements <code>orb₀</code> [SI units] and propagate the orbit until the time Δt [s].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants{T}</code>: J2 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.J2OsculatingPropagator"><code>J2OsculatingPropagator</code></a>: Structure with the initialized parameters.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L108-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2osc_init!-Tuple{J2OsculatingPropagator, KeplerianElements}" href="#SatelliteToolboxPropagators.j2osc_init!-Tuple{J2OsculatingPropagator, KeplerianElements}"><code>SatelliteToolboxPropagators.j2osc_init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2osc_init!(j2oscd::J2OsculatingPropagator, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J2 osculating orbit propagator structure <code>j2oscd</code> using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j2c::J2PropagatorConstants</code> in <code>j2oscd.j2d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L87-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j2osc_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j2osc_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j2osc_init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j2osc_init(orb₀::KeplerianElements; kwargs...) -&gt; J2OsculatingPropagator</code></pre><p>Create and initialize the J2 osculating orbit propagator structure using the mean Keplerian elements <code>orb₀</code> [SI units].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L50-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4Propagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j4!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4Propagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j4!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4!(j4d::J4Propagator{Tepoch, T}, t::Number) where {Tepoch&lt;:Number, T&lt;:Number} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit defined in <code>j4d</code> (see <a href="#SatelliteToolboxPropagators.J4Propagator"><code>J4Propagator</code></a>) to <code>t</code> [s] after the epoch of the input mean elements in <code>j4d</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The internal values in <code>j4d</code> will be modified.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L300-L322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4-Tuple{Number, KeplerianElements}" href="#SatelliteToolboxPropagators.j4-Tuple{Number, KeplerianElements}"><code>SatelliteToolboxPropagators.j4</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4(Δt::Number, orb₀::KeplerianElements; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, J4Propagator</code></pre><p>Initialize the J4 propagator structure using the input elements <code>orb₀</code> and propagate the orbit until the time Δt [s].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants</code>: J4 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.J4Propagator"><code>J4Propagator</code></a>: Structure with the initialized parameters.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L263-L293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4Propagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j4_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4Propagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j4_init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4_init!(j4d::J4Propagator, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J4 orbit propagator structure <code>j4d</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j4c::J4PropagatorConstants</code> in <code>j4d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L164-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j4_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j4_init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4_init(orb₀::KeplerianElements; kwargs...) -&gt; J4Propagator</code></pre><p>Create and initialize the J4 orbit propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants</code>: J4 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>).   (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L131-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4osc!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4OsculatingPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j4osc!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{J4OsculatingPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j4osc!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4osc!(j4oscd::J4OsculatingPropagator{Tepoch, T}, t::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit defined in <code>j4oscd</code> (see <a href="#SatelliteToolboxPropagators.J4OsculatingPropagator"><code>J4OsculatingPropagator</code></a>) to <code>t</code> [s] after the epoch of the input mean elements in <code>j4d</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The internal values in <code>j4oscd</code> will be modified.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L144-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4osc-Tuple{Number, KeplerianElements}" href="#SatelliteToolboxPropagators.j4osc-Tuple{Number, KeplerianElements}"><code>SatelliteToolboxPropagators.j4osc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4osc(Δt::Number, orb₀::KeplerianElements; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, J4OsculatingPropagator</code></pre><p>Initialize the J4 osculating propagator structure using the input elements <code>orb₀</code> and propagate the orbit until the time Δt [s].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants{T}</code>: J4 orbit propagator constants (see <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.J4OsculatingPropagator"><code>J4OsculatingPropagator</code></a>: Structure with the initialized parameters.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters. Notice that the perturbation theory requires an inertial frame with true equator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L108-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4osc_init!-Tuple{J4OsculatingPropagator, KeplerianElements}" href="#SatelliteToolboxPropagators.j4osc_init!-Tuple{J4OsculatingPropagator, KeplerianElements}"><code>SatelliteToolboxPropagators.j4osc_init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4osc_init!(j4oscd::J4OsculatingPropagator, orb₀::KeplerianElements) -&gt; Nothing</code></pre><p>Initialize the J4 osculating orbit propagator structure <code>j4oscd</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constants <code>j4c::J4PropagatorConstants</code> in <code>j4oscd.j4d</code> will not be changed. Hence, they must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L87-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.j4osc_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.j4osc_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.j4osc_init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">j4osc_init(orb₀::KeplerianElements; kwargs...) -&gt; J4OsculatingPropagator</code></pre><p>Create and initialize the J4 osculating orbit propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j4c</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>j4c::J4PropagatorConstants</code>: J4 orbit propagator constants (see   <a href="#SatelliteToolboxPropagators.J4PropagatorConstants"><code>J4PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j4c_egm2008</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L51-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.twobody!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{TwoBodyPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.twobody!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{TwoBodyPropagator{Tepoch, T}, Number}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.twobody!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">twobody!(tbd::TwoBodyPropagator{Tepoch, T}, t::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit defined in <code>tbd</code> (see <a href="#SatelliteToolboxPropagators.TwoBodyPropagator"><code>TwoBodyPropagator</code></a>) to <code>t</code> [s] after the epoch of the input mean elements in <code>tbd</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The internal values in <code>tbd</code> will be modified.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/twobody.jl#L150-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.twobody-Union{Tuple{T}, Tuple{Number, KeplerianElements}} where T&lt;:Number" href="#SatelliteToolboxPropagators.twobody-Union{Tuple{T}, Tuple{Number, KeplerianElements}} where T&lt;:Number"><code>SatelliteToolboxPropagators.twobody</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">twobody(Δt::Number, orb₀::KeplerianElements; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, TwoBodyPropagator</code></pre><p>Initialize the two-body propagator structure using the input elements <code>orb₀</code> and propagate the orbit until the time Δt [s].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the gravitational constant <code>m0</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>m0::T</code>: Standard gravitational parameter of the central body [m³ / s²].   (<strong>Default</strong> = <code>tbc_m0</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.TwoBodyPropagator"><code>TwoBodyPropagator</code></a>: Structure with the initialized parameters.</li></ul><p><strong>Remarks</strong></p><p>The inertial frame in which the output is represented depends on which frame it was used to generate the orbit parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/twobody.jl#L115-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.twobody_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{TwoBodyPropagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.twobody_init!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{TwoBodyPropagator{Tepoch, T}, KeplerianElements}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.twobody_init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">twobody_init!(tbd::TwoBodyPropagator, orb₀::KeplerianElements; kwargs...) -&gt; Nothing</code></pre><p>Initialize the two-body propagator structure <code>tbd</code> using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The propagation constant <code>μ::Number</code> in <code>tbd</code> will not be changed. Hence, it must be initialized.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/twobody.jl#L85-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.twobody_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.twobody_init-Union{Tuple{KeplerianElements{Tepoch, Tkepler}}, Tuple{T}, Tuple{Tkepler}, Tuple{Tepoch}} where {Tepoch&lt;:Number, Tkepler&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.twobody_init</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">twobody_init(orb₀::KeplerianElements; kwargs...) -&gt; TwoBodyPropagator</code></pre><p>Create and initialize the two-body propagator structure using the mean Keplerian elements <code>orb₀</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the gravitational constant <code>m0</code>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>m0::T</code>: Standard gravitational parameter of the central body [m³ / s²].   (<strong>Default</strong> = <code>tbc_m0</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/twobody.jl#L53-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j2_mean_elements_epoch!-Tuple{J2Propagator, KeplerianElements, Dates.DateTime}" href="#SatelliteToolboxPropagators.update_j2_mean_elements_epoch!-Tuple{J2Propagator, KeplerianElements, Dates.DateTime}"><code>SatelliteToolboxPropagators.update_j2_mean_elements_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j2_mean_elements_epoch!(j2d::J2Propagator, orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using the propagator <code>j2d</code> to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J2 orbit propagator <code>j2d</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

# Allocate a new J2 orbit propagator using the created Keplerian elements. Notice that any
# set of Keplerian elements can be used here.
julia&gt; j2d = j2_init(orb);

julia&gt; update_j2_mean_elements_epoch!(j2d, orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9565   °
 Arg. of Perigee :  197.078    °
    True Anomaly :  127.291    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L826-L872">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j2_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators.update_j2_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators.update_j2_mean_elements_epoch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j2_mean_elements_epoch(orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using a J2 orbit propagator to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch!-Tuple{J2OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>update_j2osc_mean_elements_epoch!</code></a> instead.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

julia&gt; update_j2_mean_elements_epoch(orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9565   °
 Arg. of Perigee :  197.078    °
    True Anomaly :  127.291    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2.jl#L769-L812">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch!-Tuple{J2OsculatingPropagator, KeplerianElements, Dates.DateTime}" href="#SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch!-Tuple{J2OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j2osc_mean_elements_epoch!(j2oscd::J2OsculatingPropagator, orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using the propagator <code>j2oscd</code> to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J2 osculating orbit propagator <code>j2oscd</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

# Allocate a new J2 osculating orbit propagator using the created Keplerian elements. Notice
# that any set of Keplerian elements can be used here.
julia&gt; j2oscd = j2osc_init(orb);

julia&gt; update_j2osc_mean_elements_epoch!(j2oscd, orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9565   °
 Arg. of Perigee :  197.078    °
    True Anomaly :  127.291    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L766-L812">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j2osc_mean_elements_epoch(orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using a J2 osculating orbit propagator to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J2 osculating propagator with the default constants <code>j2c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.update_j2osc_mean_elements_epoch!-Tuple{J2OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>update_j2osc_mean_elements_epoch!</code></a> instead.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

julia&gt; update_j2osc_mean_elements_epoch(orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9565   °
 Arg. of Perigee :  197.078    °
    True Anomaly :  127.291    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j2osc.jl#L705-L748">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j4_mean_elements_epoch!-Tuple{J4Propagator, KeplerianElements, Dates.DateTime}" href="#SatelliteToolboxPropagators.update_j4_mean_elements_epoch!-Tuple{J4Propagator, KeplerianElements, Dates.DateTime}"><code>SatelliteToolboxPropagators.update_j4_mean_elements_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j4_mean_elements_epoch!(j4d::J4Propagator, orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using the propagator <code>j4d</code> to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J4 orbit propagator <code>j4d</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

# Allocate a new J4 orbit propagator using the created Keplerian elements. Notice that any
# set of Keplerian elements can be used here.
julia&gt; j4d = j4_init(orb);

julia&gt; update_j4_mean_elements_epoch!(j4d, orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9555   °
 Arg. of Perigee :  197.079    °
    True Anomaly :  127.293    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L860-L906">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j4_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators.update_j4_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators.update_j4_mean_elements_epoch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j4_mean_elements_epoch(orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using a J4 orbit propagator to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch!-Tuple{J4OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>update_j4osc_mean_elements_epoch!</code></a> instead.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

julia&gt; update_j4_mean_elements_epoch(orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9555   °
 Arg. of Perigee :  197.079    °
    True Anomaly :  127.293    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4.jl#L803-L846">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch!-Tuple{J4OsculatingPropagator, KeplerianElements, Dates.DateTime}" href="#SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch!-Tuple{J4OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j4osc_mean_elements_epoch!(j4oscd::J4OsculatingPropagator, orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using the propagator <code>j4oscd</code> to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The J4 osculating orbit propagator <code>j4oscd</code> will be initialized with the Keplerian elements returned by the function.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

# Allocate a new J4 osculating orbit propagator using the created Keplerian elements. Notice
# that any set of Keplerian elements can be used here.
julia&gt; j4oscd = j4osc_init(orb);

julia&gt; update_j4osc_mean_elements_epoch!(j4oscd, orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9555   °
 Arg. of Perigee :  197.079    °
    True Anomaly :  127.293    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L765-L811">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}" href="#SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch-Union{Tuple{Tepoch}, Tuple{T}, Tuple{KeplerianElements{Tepoch, T}, Union{Dates.DateTime, Number}}} where {T&lt;:Number, Tepoch&lt;:Number}"><code>SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_j4osc_mean_elements_epoch(orb::KeplerianElements, new_epoch::Union{Number, DateTime}) -&gt; KepleriranElements</code></pre><p>Update the epoch of the mean elements <code>orb</code> using a J4 osculating orbit propagator to <code>new_epoch</code>, which can be represented by a Julian Day or a <code>DateTime</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This algorithm version will allocate a new J4 osculating propagator with the default constants <code>j4c_egm2008</code>. If another set of constants are required, use the function <a href="#SatelliteToolboxPropagators.update_j4osc_mean_elements_epoch!-Tuple{J4OsculatingPropagator, KeplerianElements, Dates.DateTime}"><code>update_j4osc_mean_elements_epoch!</code></a> instead.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           DateTime(&quot;2023-01-01&quot;) |&gt; datetime2julian,
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           90     |&gt; deg2rad,
           200    |&gt; deg2rad,
           45     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.0      °
 Arg. of Perigee :  200.0      °
    True Anomaly :   45.0      °

julia&gt; update_j4osc_mean_elements_epoch(orb, DateTime(&quot;2023-01-02&quot;))
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-02T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :   90.9555   °
 Arg. of Perigee :  197.079    °
    True Anomaly :  127.293    °</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/propagators/j4osc.jl#L704-L747">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.OrbitPropagator" href="#SatelliteToolboxPropagators.Propagators.OrbitPropagator"><code>SatelliteToolboxPropagators.Propagators.OrbitPropagator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type OrbitPropagator{Tepoch&lt;:Number, T&lt;:Number}</code></pre><p>Abstract type for the orbit propagators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.epoch" href="#SatelliteToolboxPropagators.Propagators.epoch"><code>SatelliteToolboxPropagators.Propagators.epoch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">epoch(orbp::OrbitPropagator{Tepoch, T}) where {Tepoch&lt;:Number, T&lt;:Number} -&gt; Tepoch</code></pre><p>Return the initial elements&#39; epoch of the propagator <code>orbp</code> [JD].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit_mean_elements(::Val{:propagator}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; &lt;Mean elements&gt;</code></pre><p>Fit a set of mean elements for the <code>propagator</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day]. The keywords <code>kwargs</code> depends on the propagator type.</p><p>This function returns the set of mean elements used to initialize the <code>propagator</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.fit_mean_elements!" href="#SatelliteToolboxPropagators.Propagators.fit_mean_elements!"><code>SatelliteToolboxPropagators.Propagators.fit_mean_elements!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit_mean_elements!(orbp::OrbitPropagator, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {Tjd&lt;:Number, Tv&lt;:AbstractVector} -&gt; &lt;Mean elements&gt;</code></pre><p>Fit a set of mean elements for the propagator <code>orbp</code> using the osculating elements represented by a set of position vectors <code>vr_i</code> [m] and a set of velocity vectors <code>vv_i</code> [m / s] represented in an inertial reference frame at instants in the array <code>vjd</code> [Julian Day]. The keywords <code>kwargs</code> depends on the propagator type.</p><p>This function returns the set of mean elements used to initialize the <code>propagator</code> and also initializes <code>orbp</code> with the fitted mean elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L53-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init" href="#SatelliteToolboxPropagators.Propagators.init"><code>SatelliteToolboxPropagators.Propagators.init</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">init(::Val{:propagator}, args...; kwargs...) -&gt; OrbitPropagator</code></pre><p>Create and initialize the orbit <code>propagator</code>. The arguments <code>args</code> and keywords <code>kwargs</code> depends of the propagator type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L66-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.init!" href="#SatelliteToolboxPropagators.Propagators.init!"><code>SatelliteToolboxPropagators.Propagators.init!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">init!(orbp::OrbitPropagator, args...; kwargs...) -&gt; Nothing</code></pre><p>Initialize the orbit propagator <code>orbp</code>. The arguments <code>args</code> and keywords <code>kwargs</code> depends of the propagator type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.last_instant" href="#SatelliteToolboxPropagators.Propagators.last_instant"><code>SatelliteToolboxPropagators.Propagators.last_instant</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">last_instant(orbp::OrbitPropagator{Tepoch, T}) where {Tepoch&lt;:Number, T&lt;:Number} -&gt; T</code></pre><p>Return the last propagation instant [s] measured from the epoch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.mean_elements-Tuple{OrbitPropagator}" href="#SatelliteToolboxPropagators.Propagators.mean_elements-Tuple{OrbitPropagator}"><code>SatelliteToolboxPropagators.Propagators.mean_elements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mean_elements(orbp::OrbitPropagator) -&gt; Union{Nothing, KeplerianElements}</code></pre><p>Return the mean elements using the structure <code>KeplerianElements</code> of the latest propagation performed by <code>orbp</code>. This is an optinal function in the API. It will return <code>nothing</code> if the propagator does not support it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L96-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.name-Tuple{OrbitPropagator}" href="#SatelliteToolboxPropagators.Propagators.name-Tuple{OrbitPropagator}"><code>SatelliteToolboxPropagators.Propagators.name</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">name(orbp::OrbitPropagator) -&gt; String</code></pre><p>Return the name of the orbit propagator <code>orbp</code>. If this function is not defined, the structure name is used: <code>typeof(orbp) |&gt; string</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L105-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate!" href="#SatelliteToolboxPropagators.Propagators.propagate!"><code>SatelliteToolboxPropagators.Propagators.propagate!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">propagate!(orbp::OrbitPropagator{Tepoch, T}, t::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit using <code>orbp</code> by <code>t</code> [s] from the initial orbit epoch.</p><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L170-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{OrbitPropagator{Tepoch, T}, AbstractVector}} where {Tepoch&lt;:Number, T&lt;:Number}" href="#SatelliteToolboxPropagators.Propagators.propagate!-Union{Tuple{T}, Tuple{Tepoch}, Tuple{OrbitPropagator{Tepoch, T}, AbstractVector}} where {Tepoch&lt;:Number, T&lt;:Number}"><code>SatelliteToolboxPropagators.Propagators.propagate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate!(orbp::OrbitPropagator{Tepoch, T}, vt::AbstractVector; kwargs...) where {Tepoch &lt;: Number, T &lt;: Number} -&gt; Vector{SVector{3, T}}, Vector{SVector{3, T}}</code></pre><p>Propagate the orbit using <code>orbp</code> for every instant defined in <code>vt</code> [s].</p><p><strong>Keywords</strong></p><ul><li><code>ntasks::Integer</code>: Number of parallel tasks to propagate the orbit. If it is set to a   number equal or lower than 1, the function will propagate the orbit sequentially.   (<strong>Default</strong> = <code>Threads.nthreads()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{SVector{3, T}}</code>: Array with the position vectors [m] in the inertial frame at each   propagation instant defined in <code>vt</code>.</li><li><code>Vector{SVector{3, T}}</code>: Array with the velocity vectors [m / s] in the inertial frame at   each propagation instant defined in <code>vt</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L184-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate-Tuple{Any, AbstractVector, Vararg{Any}}" href="#SatelliteToolboxPropagators.Propagators.propagate-Tuple{Any, AbstractVector, Vararg{Any}}"><code>SatelliteToolboxPropagators.Propagators.propagate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate(::Val{:propagator}, vt::AbstractVector, args...; kwargs...) -&gt; Vector{SVector{3, T}}, Vector{SVector{3, T}}, OrbitPropagator{Tepoch, T}</code></pre><p>Initialize the orbit <code>propagator</code> and propagate the orbit for every instant defined in <code>vt</code> [s] from the initial orbit epoch. The initialization arguments <code>args...</code> and <code>kwargs...</code> (except for <code>ntasks</code>) are the same as in the initialization function <a href="#SatelliteToolboxPropagators.Propagators.init"><code>Propagators.init</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>T</code> is the propagator number type. For more information, see <a href="#SatelliteToolboxPropagators.Propagators.init"><code>Propagators.init</code></a>.</p></div></div><p><strong>Keywords</strong></p><ul><li><code>ntasks::Integer</code>: Number of parallel tasks to propagate the orbit. If it is set to a   number equal or lower than 1, the function will propagate the orbit sequentially.   (<strong>Default</strong> = <code>Threads.nthreads()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{SVector{3, T}}</code>: Array with the position vectors [m] in the inertial frame at each   propagation instant defined in <code>vt</code>.</li><li><code>Vector{SVector{3, T}}</code>: Array with the velocity vectors [m / s] in the inertial frame at   each propagation instant defined in <code>vt</code>.</li><li><a href="#SatelliteToolboxPropagators.Propagators.OrbitPropagator"><code>OrbitPropagator{Tepoch, T}</code></a>: Structure with the initialized propagator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L138-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate-Tuple{Any, Number, Vararg{Any}}" href="#SatelliteToolboxPropagators.Propagators.propagate-Tuple{Any, Number, Vararg{Any}}"><code>SatelliteToolboxPropagators.Propagators.propagate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate(::Val{:propagator}, Δt::Number, args...; kwargs...) -&gt; SVector{3, T}, SVector{3, T}, OrbitPropagator{Tepoch, T}</code></pre><p>Initialize the orbit <code>propagator</code> and propagate the orbit by <code>t</code> [s] from the initial orbit epoch. The initialization arguments <code>args...</code> and <code>kwargs...</code> are the same as in the initialization function <a href="#SatelliteToolboxPropagators.Propagators.init"><code>Propagators.init</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>T</code> is the propagator number type. For more information, see <a href="#SatelliteToolboxPropagators.Propagators.init"><code>Propagators.init</code></a>.</p></div></div><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.Propagators.OrbitPropagator"><code>OrbitPropagator{Tepoch, T}</code></a>: Structure with the initialized propagator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L113-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate_to_epoch!-Tuple{OrbitPropagator, AbstractVector}" href="#SatelliteToolboxPropagators.Propagators.propagate_to_epoch!-Tuple{OrbitPropagator, AbstractVector}"><code>SatelliteToolboxPropagators.Propagators.propagate_to_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate_to_epoch!(orbp::OrbitPropagator{Tepoch, T}, vjd::AbstractVector; kwargs...) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit using <code>orbp</code> for every epoch defined in <code>jd</code> [Julian Day].</p><p><strong>Keywords</strong></p><ul><li><code>ntasks::Integer</code>: Number of parallel tasks to propagate the orbit. If it is set to a   number equal or lower than 1, the function will propagate the orbit sequentially.   (<strong>Default</strong> = <code>Threads.nthreads()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{SVector{3, T}}</code>: Array with the position vectors [m] in the inertial frame at each   propagation instant defined in <code>vt</code>.</li><li><code>Vector{SVector{3, T}}</code>: Array with the velocity vectors [m / s] in the inertial frame at   each propagation instant defined in <code>vt</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L289-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate_to_epoch!-Tuple{OrbitPropagator, Number}" href="#SatelliteToolboxPropagators.Propagators.propagate_to_epoch!-Tuple{OrbitPropagator, Number}"><code>SatelliteToolboxPropagators.Propagators.propagate_to_epoch!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate_to_epoch!(orbp::OrbitPropagator{Tepoch, T}, jd::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit using <code>orbp</code> until the epoch <code>jd</code> [Julian Day].</p><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L273-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.propagate_to_epoch-Tuple{Val, Number, Vararg{Any}}" href="#SatelliteToolboxPropagators.Propagators.propagate_to_epoch-Tuple{Val, Number, Vararg{Any}}"><code>SatelliteToolboxPropagators.Propagators.propagate_to_epoch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate_to_epoch(::Val{:propagator}, jd::Number, args...; kwargs...)</code></pre><p>Initialize the orbit <code>propagator</code> and propagate the orbit until the epoch <code>jd</code> [s] from the initial orbit epoch. The initialization arguments <code>args...</code> and <code>kwargs...</code> are the same as in the initialization function <a href="#SatelliteToolboxPropagators.Propagators.init"><code>Propagators.init</code></a>.</p><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li><li><a href="#SatelliteToolboxPropagators.Propagators.OrbitPropagator"><code>OrbitPropagator</code></a>: Structure with the initialized parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L252-L266">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SatelliteToolboxPropagators.Propagators.step!-Tuple{OrbitPropagator, Number}" href="#SatelliteToolboxPropagators.Propagators.step!-Tuple{OrbitPropagator, Number}"><code>SatelliteToolboxPropagators.Propagators.step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">step!(orbp::OrbitPropagator{Tepoch, T}, Δt::Number) where {Tepoch, T} -&gt; SVector{3, T}, SVector{3, T}</code></pre><p>Propagate the orbit using <code>orbp</code> by <code>Δt</code> [s] from the current orbit epoch.</p><p><strong>Returns</strong></p><ul><li><code>SVector{3, T}</code>: Position vector [m] represented in the inertial frame at propagation   instant.</li><li><code>SVector{3, T}</code>: Velocity vector [m / s] represented in the inertial frame at propagation   instant.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/dbf8e98545bcf48490d9a2601a7b7d299e071cbc/src/api/Propagators.jl#L311-L322">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../man/propagators/twobody/">« Two-Body</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 19 June 2024 07:21">Wednesday 19 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
