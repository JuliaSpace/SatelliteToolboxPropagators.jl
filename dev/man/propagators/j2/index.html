<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>J2 · Satellite Toolbox Propagators</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://juliaspace.github.io/SatelliteToolboxPropagators.jl/stable/man/propagators/j2/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Satellite Toolbox Propagators</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../quick_start/">Quick Start</a></li><li><a class="tocitem" href="../../usage/">Usage</a></li><li><span class="tocitem">Propagators</span><ul><li class="is-active"><a class="tocitem" href>J2</a><ul class="internal"><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li><li><a class="tocitem" href="#Initialization"><span>Initialization</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../j2osc/">J2 Osculating</a></li><li><a class="tocitem" href="../j4/">J4</a></li><li><a class="tocitem" href="../j4osc/">J4 Osculating</a></li><li><a class="tocitem" href="../sgp4/">SGP4/SDP4</a></li><li><a class="tocitem" href="../twobody/">Two-Body</a></li></ul></li><li><a class="tocitem" href="../../../lib/library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Propagators</a></li><li class="is-active"><a href>J2</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>J2</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSpace/SatelliteToolboxPropagators.jl/blob/main/docs/src/man/propagators/j2.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="J2_Propagator"><a class="docs-heading-anchor" href="#J2_Propagator">J2 Analytical Orbit Propagator</a><a id="J2_Propagator-1"></a><a class="docs-heading-anchor-permalink" href="#J2_Propagator" title="Permalink"></a></h1><p>The J2 analytical orbit propagator considers only the J2 perturbation term of the geopotential field to obtain a simple analytic solution for propagating the mean orbital elements. It has low precision but is extremely useful during mission design. For example, when designing a Sun-Synchronous orbit for a remote sensing mission, the satellite usually has a propulsion subsystem to maintain its orbit. Hence, the J2 propagator solution can be used as the nominal orbit through the mission lifetime to perform initial studies.</p><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><p>The algorithm implemented here is based on <strong>[1, 2]</strong>. This version takes into account only the secular effects in the orbit elements.</p><p>After neglecting all terms with higher order than J2, we obtain that only the right accession of the ascending node (RAAN), the argument of perigee, and mean motion are perturbed by the geopotential field with secular effects. However, we also include the possibility of inputting the mean motion time derivatives to consider effects like energy dissipation by air drag.  Hence, the algorithm propagates the mean elements using the following equations:</p><p class="math-container">\[\begin{aligned}
  a(t)       &amp;= a_0 - \frac{2}{3} \cdot \frac{\dot{n}}{n_0} \cdot a_0 \cdot \left(t - t_0\right) \\
  e(t)       &amp;= e_0 - \frac{2}{3} \cdot \left(1 - e_0\right) \cdot \frac{\dot{n}}{n_0} \cdot \left(t - t_0\right) \\
  \bar{n}(t) &amp;= n_0 \cdot \left[1 + \frac{3}{4} \cdot J_2 \cdot \left(\frac{R_0}{p_0}\right)^2 \cdot \sqrt{1 - e_0^2} \cdot \left(2 - 3\sin{i_0}^2\right)\right] \cdot \left(t - t_0\right) \\
  \Omega(t)  &amp;= \Omega_0 - \frac{2}{3} \cdot J_2 \cdot \left(\frac{R_0}{p_0}\right)^2 \cdot \bar{n} \cdot \cos{i_0} \cdot \left(t - t_0\right) \\
  \omega(t)  &amp;= \omega_0 + \frac{3}{4} \cdot J_2 \cdot \left(\frac{R_0}{p_0}\right)^2 \cdot \left(4 - 5\sin{i_0}^2\right) \cdot \left(t - t_0\right) \\
  M(t)       &amp;= M_0 + \bar{n} \cdot \left(t - t_0\right) + \frac{\dot{n}}{2} \cdot \left(t - t_0\right)^2 + \frac{\ddot{n}}{6} \cdot \left(t - t_0\right)^3 \\
\end{aligned}\]</p><p>where the subscript <span>$_0$</span> indicates the initial element, <span>$t_0$</span> is the initial mean elements&#39; epoch, <span>$a$</span> is the mean semi-major axis, <span>$n$</span> is mean motion, <span>$\bar{n}$</span> is the perturbed mean motion, <span>$e$</span> is the eccentricity, <span>$p$</span> is the <em>semi-latus rectum</em>, <span>$R_0$</span> is the Earth&#39;s equatorial radius, <span>$\Omega$</span> is the RAAN, and <span>$M$</span> is the mean anomaly.</p><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><p>We can initialize the J2 analytical orbit propagator with the following function:</p><pre><code class="language-julia hljs">function Propagators.init(Val(:J2), orb₀::KeplerianElements, dn_o2::Number = 0, ddn_o6::Number = 0; kwargs...)</code></pre><p>which creates a J2 propagator structure <a href="../../../lib/library/#SatelliteToolboxPropagators.OrbitPropagatorJ2"><code>OrbitPropagatorJ2</code></a> with the mean Keplerian elements <code>orb₀</code>. It supports the following positional arguments:</p><ul><li><code>orb₀::KeplerianElements</code>: Initial mean Keplerian elements [SI units].</li><li><code>dn_o2::Number</code>: First time derivative of the mean motion divided by two [rad/s^2].   (<strong>Default</strong> = 0)</li><li><code>ddn_o6::Number</code>: Second time derivative of the mean motion divided by six [rad/s^3].   (<strong>Default</strong> = 0)</li></ul><p>The following keyword selects the gravitational constants for the propagation algorithm:</p><ul><li><code>j2c::J2PropagatorConstants</code>: J2 orbit propagator constants (see <a href="../../../lib/library/#SatelliteToolboxPropagators.J2PropagatorConstants"><code>J2PropagatorConstants</code></a>). (<strong>Default</strong> = <code>j2c_egm2008</code>)</li></ul><p>This package contains some pre-built propagation constants for this propagator:</p><table><tr><th style="text-align: right"><strong>J2 Propagator Constant</strong></th><th style="text-align: left"><strong>Description</strong></th><th style="text-align: left"><strong>Type</strong></th></tr><tr><td style="text-align: right"><code>j2c_egm2008</code></td><td style="text-align: left">EGM-2008 gravitational constants</td><td style="text-align: left"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>j2c_egm2008_f32</code></td><td style="text-align: left">EGM-2008 gravitational constants</td><td style="text-align: left"><code>Float32</code></td></tr><tr><td style="text-align: right"><code>j2c_egm1996</code></td><td style="text-align: left">EGM-1996 gravitational constants</td><td style="text-align: left"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>j2c_egm1996_f32</code></td><td style="text-align: left">EGM-1996 gravitational constants</td><td style="text-align: left"><code>Float32</code></td></tr><tr><td style="text-align: right"><code>j2c_jgm02</code></td><td style="text-align: left">JGM-02 gravitational constants</td><td style="text-align: left"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>j2c_jgm02_f32</code></td><td style="text-align: left">JGM-02 gravitational constants</td><td style="text-align: left"><code>Float32</code></td></tr><tr><td style="text-align: right"><code>j2c_jgm03</code></td><td style="text-align: left">JGM-03 gravitational constants</td><td style="text-align: left"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>j2c_jgm03_f32</code></td><td style="text-align: left">JGM-03 gravitational constants</td><td style="text-align: left"><code>Float32</code></td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The type used in the propagation will be the same as used to define the constants in the structure <code>j2c</code>.</p></div></div><pre><code class="language-julia-repl hljs">julia&gt; orb = KeplerianElements(
           date_to_jd(2023, 1, 1, 0, 0, 0),
           7190.982e3,
           0.001111,
           98.405 |&gt; deg2rad,
           100    |&gt; deg2rad,
           90     |&gt; deg2rad,
           19     |&gt; deg2rad
       )
KeplerianElements{Float64, Float64}:
           Epoch :    2.45995e6 (2023-01-01T00:00:00)
 Semi-major axis : 7190.98     km
    Eccentricity :    0.001111
     Inclination :   98.405    °
            RAAN :  100.0      °
 Arg. of Perigee :   90.0      °
    True Anomaly :   19.0      °

julia&gt; orbp = Propagators.init(Val(:J2), orb; j2c = j2c_jgm03)
OrbitPropagatorJ2{Float64, Float64}:
   Propagator name : J2 Orbit Propagator
  Propagator epoch : 2023-01-01T00:00:00
  Last propagation : 2023-01-01T00:00:00</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li><strong>[1]</strong> <strong>Vallado, D. A</strong> (2013). <em>Fundamentals of Astrodynamics and Applications</em>. 4th ed. <strong>Microcosm Press</strong>, Hawthorn, CA, USA.</li><li><strong>[2]</strong> <strong>Wertz, J. R</strong> (1978). <em>Spacecraft Attitude Determination and Control</em>. <strong>Kluwer Academic Publishers</strong>, Dordrecht, The Netherlands.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../usage/">« Usage</a><a class="docs-footer-nextpage" href="../j2osc/">J2 Osculating »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 1 July 2023 14:34">Saturday 1 July 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
